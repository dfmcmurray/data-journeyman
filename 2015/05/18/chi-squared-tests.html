<!DOCTYPE html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Chi-Squared Tests</title><meta name=viewport content="width=device-width"><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css><link rel=stylesheet href=/css/main.4538.css></head><body><div class=site><div id=header><a href="/"><!-- <img class="title" src="/img/title-anglecia.4d4e.png" /> --><div class=title>Data Journeyman</div><div class=tagline>One man's journey from noise to knowledge<img src=/img/datum.cd72.png></div></a></div><div class=post-container><div class=post-heading><h2>Chi-Squared Tests</h2><p class=meta>18 May 2015</p><div class=tags><span class="tag Curriculum">Curriculum</span> <span class="tag Inferential Stats">Inferential Stats</span> <span class="tag Statistics">Statistics</span> <span class="tag Video">Video</span> <span class="tag Distribution Exposition">Distribution Exposition</span></div></div><div class=post><h3 id=chi-squared-distribution>Chi-Squared Distribution</h3><p>In <a href=http://www.datajourneyman.com/2015/05/11/comparing-populations.html>the last post</a>, we saw what happened when we composed distributions with addition and subtraction, but what if we look at a non-linear composition? If you have n normal random variables (\(X_1, X_2, \dots, X_n\)), then we can define Q as the sum of their squares. What distribution would Q belong to? The answer: a chi-squared (\(\chi^2\)) distribution.</p><p>\[ \begin{eqnarray} X_i &amp; \widetilde{ } &amp; N(0, 1)\cr Q &amp;=&amp; \sum_i X_i^2\cr Q &amp; \widetilde{ } &amp; \chi_{n}^2 \end{eqnarray} \]</p><p>The n subscript on the \(\chi^2\) distribution that Q is a member of denotes the degrees of freedom for the distribution. It represents the minimum number of values you need defined to fully describe the distribution. In this case, the degrees of freedom is just n, but that won’t always be the case, as we’ll soon see.</p><p>Chi-squared distribution values are always positive (since they’re sums of squares), and they’re very useful in the analysis of error. We can use this distribution to test experimental values with a theoretical distribution (goodness of fit) or to test the independence (or alternatively, contingency) of outcomes along two experimental axis (test of independence). Let’s look at two examples of chi-squared tests to see how.</p><h3 id=chi-squared-tests>Chi-Squared Tests</h3><h4 id=restaurant-patronage-example-goodness-of-fit>Restaurant Patronage Example (Goodness of Fit)</h4><p>A restaurant owner has come up with a theoretical distribution based on her experience running a restaurant for a few years. She might want to make some decisions to alter the menu based on this model, so she wants you to verify whether it’s right.</p><p>In this table are her theoretical percentages for each day (she’s closed on Sunday) as well as last week’s actual patronage numbers.</p><table><tbody><tr><td></td><td>Mon</td><td>Tue</td><td>Wed</td><td>Thu</td><td>Fri</td><td>Sat</td></tr><tr><td>Theoretical %</td><td>10</td><td>10</td><td>15</td><td>20</td><td>30</td><td>15</td></tr><tr><td>Actual Numbers</td><td>30</td><td>14</td><td>34</td><td>45</td><td>57</td><td>20</td></tr></tbody></table><p>We can use the chi-squared distribution to test how well the actual number fit the theoretical distribution. Let’s perform a hypothesis test to see whether the owner’s assumptions are valid. We will use an alpha value of 0.05.</p><p>\[H_0: \text{Owner’s distribution is correct}\] \[H_1: \text{Owner’s distribution is not correct}\]</p><p>Assuming \(H_0\), we can use the theorectical distribution to calculate exactly how many customers we would expect to see each day while keeping the total number of customers the same (200).</p><table><tbody><tr><td></td><td>Mon</td><td>Tue</td><td>Wed</td><td>Thu</td><td>Fri</td><td>Sat</td></tr><tr><td>Expected Numbers</td><td>20</td><td>20</td><td>30</td><td>40</td><td>60</td><td>30</td></tr></tbody></table><p>Now we will use <a href=http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test>Pearson’s chi-squared test</a> to generate our chi-squared statistic to be compared with the chi-squared distribution. (Pearson’s method is the most common, but you should be aware that there are other methods out there, like <a href=http://en.wikipedia.org/wiki/Yates%27s_correction_for_continuity>Yates’s</a>.)</p><p>Pearson’s chi-squared test is defined as follows:</p><p>\[\chi^2 = \sum_i \frac{(O_i - E_i)^2}{E_i} \]</p><p>So in the restuarant example:</p><p>\[\chi^2 = \frac{(30-20)^2}{20} + \frac{(14-20)^2}{20} + \frac{(34-30)^2}{30} + \frac{(45-40)^2}{40} + \frac{(57-60)^2}{60} + \frac{(20-30)^2}{30} = 11.44\]</p><p>The degree of freedom is 5 because we fixed the total number of customers, so if you know the first five days, the sixth day is fixed.</p><p>Now if we look at a <a href=http://sites.stat.psu.edu/~mga/401/tables/Chi-square-table.pdf>chi-squared table</a>, we can find the column that corresponds with our alpha value (0.050) and the row that corresponds with our degrees of freedom (5) and we get a value of 11.07, which we will call our critical value.</p><p>Since our calculated chi-squared statistic is greater than the critical value, getting that much error has less than a 5% chance of happening by chance, and we can reject the null hypothesis.</p><h4 id=a-note-on-normality>A Note on Normality</h4><p>You can see that since we could use the chi-squared test to test how well the data matched this arbitrary theoretical distribution, you could use it for any distribution that you had a definition for, whether it’s laid out for each value (like it is in this example) or if its PDF is given.</p><p>But remember, the chi-squared distribution is a sum of squares of <em>normal</em> random variables. The normal distribution comes into play here because we’re squaring the error (the difference between the observed value and the expected value) and this error is expected to be normal.</p><h4 id=medical-herbs-example-test-of-independence>Medical Herbs Example (Test of Independence)</h4><p>We can also use the chi-squared distribution to test whether different populations have different experimental outcomes or if each population’s result is independent of its population. This relationship is often captured in a <a href=http://en.wikipedia.org/wiki/Contingency_table>contingency table</a>.</p><p>Suppose you want to test the effectiveness of two herbs on the recovery rate of an illness. You run an experiment with 380 subjects, breaking them up into three groups for Herb 1, Herb 2, and a control group that gets a placebo. At the end of the trial, you record who is still sick and who isn’t.</p><table><tbody><tr><td></td><td>Herb 1</td><td>Herb 2</td><td>Placebo</td><td>Total</td></tr><tr><td># sick</td><td>20</td><td>30</td><td>30</td><td>80</td></tr><tr><td># not sick</td><td>100</td><td>110</td><td>90</td><td>300</td></tr><tr><td>Total</td><td>120</td><td>140</td><td>120</td><td>380</td></tr></tbody></table><p>The bottom row and right column have the marginal totals, and the bottom-most, right-most cell is the grand total.</p><p>So, let’s perform a hypothesis test with a significance level (\(\alpha\)) of 0.01.</p><p>\[H_0: \text{The herbs do not affect recovery rate}\] \[H_1: \text{The herbs have an effect on recovery rate}\]</p><p>Assuming \(H_0\) to be true, all three groups had no medical benefit, so the illness has a \(\frac{80}{380} = 21\%\) recovery rate. Keeping the totals constant in each group, we can calculate the expected outcomes.</p><table><tbody><tr><td></td><td>Herb 1</td><td>Herb 2</td><td>Placebo</td></tr><tr><td>expected # sick</td><td>25.2</td><td>29.4</td><td>25.2</td></tr><tr><td>expected # not sick</td><td>94.8</td><td>110.6</td><td>94.8</td></tr></tbody></table><p>The degree of freedom here is only 2, though. That’s because we have not only have the grand total, but we have the marginal totals which are fixed and can be used to solve the last value in each row/column. The general formula for degrees of freedom with a contingency table is<nobr>(r - 1) * (c - 1).</nobr>Here, that works out to be<nobr>(2 - 1) * (3 - 1) = (1) * (2) = 2.</nobr></p><p>Now we need to calculate our chi-squared statistic.</p><p>\[\chi^2 = \frac{(20-25.2)^2}{25.2} + \frac{(30-29.4)^2}{29.4} + \frac{(30-25.2)^2}{25.2} + \frac{(100-94.8)^2}{94.8} + \frac{(110-110.6)^2}{110.6} + \frac{(90-94.8)^2}{94.8} = 2.53\]</p><p>Using the chi-squared table from before, we can use our degrees of freedom (2) and our alpha (0.01) to determine our critical value is 4.60. Since our calculated chi-squared statistic is less than our critical value, we cannot reject the null hypothesis in this case.</p><h3 id=wrapping-up>Wrapping Up</h3><p>Next week, we’ll look at another method (ANOVA) for hypothesis testing contingency table data under slightly different circumstances than above. We’ll use the chi-squared distribution to derive another distribution that will help us there. And that will bring us to the end of our look at inferential statistics, with many of the most common experimental methods in our toolbelt.</p></div><div class=comments><div id=disqus_thread></div><script type=text/javascript>/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	        var disqus_shortname = 'datajourneyman'; // required: replace example with your forum shortname

	        /* * * DON'T EDIT BELOW THIS LINE * * */
	        (function() {
	            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	        })();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><script src=//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js></script><script src=//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js></script><script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({
		"HTML-CSS": { linebreaks: { automatic: true } },
		SVG: { linebreaks: { automatic: true } },
		TeX: { 
            Macros: { 
              goodbreak: '\\mmlToken{mo}[linebreak="goodbreak"]{}', 
              badbreak: ['\\mmlToken{mo}[linebreak="badbreak"]{#1}',1], 
              nobreak: ['\\mmlToken{mo}[linebreak="nobreak"]{#1}',1], 
              invisibletimes: ['\\mmlToken{mo}{\u2062}'] 
            } 
        } 
    });</script><script src=/js/scripts.08ae.js></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-10466691-5', 'auto');
  ga('send', 'pageview');</script></body></html>